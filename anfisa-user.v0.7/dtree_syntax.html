
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Decision Tree Syntax Reference &#8212; Anfisa User Documentation v.0.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/pyramid.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notes on Zygosity" href="zygosity.html" />
    <link rel="prev" title="Filtering functions" href="func_ref.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="zygosity.html" title="Notes on Zygosity"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="func_ref.html" title="Filtering functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Anfisa User Documentation v.0.7 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Decision Tree Syntax Reference</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="decision-tree-syntax-reference">
<h1>Decision Tree Syntax Reference<a class="headerlink" href="#decision-tree-syntax-reference" title="Permalink to this heading">¶</a></h1>
<p>In the text below we define and discuss a dialect of Python that is used to construct a decision tree.</p>
<p>Decision tree is an algorithm of filtration that allows to build complex procedure of variants selection.</p>
<section id="decision-tree-logic">
<h2>Decision tree logic<a class="headerlink" href="#decision-tree-logic" title="Permalink to this heading">¶</a></h2>
<p>A Decision Tree consists of a sequence of branching points. A result of application of any Decision Tree is a set that we will call “final selection”. The process starts with a set consisting of all of the variants (in a whole genome of patient family members or a cohort of patients). This set “travels” through a tree trunk. At each branching point a subset of variants is removed from the set and is either excluded from further consideration (thrown away) or unconditionally included in the final selection. Variants that have been neither excluded or included continue their “travel”.</p>
<ul class="simple">
<li><p>Initially we have the whole set of items (variants) as working selection.</p></li>
<li><dl class="simple">
<dt>At each branching point:</dt><dd><ul>
<li><p>If-instruction selects some subset of working selection;</p></li>
<li><p>Return-instruction determines whether the selected subset should be included in the “final selection” (return <code class="docutils literal notranslate"><span class="pre">True</span></code>) or excluded (return <code class="docutils literal notranslate"><span class="pre">False</span></code>):</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="line-block">
<div class="line"><strong>if</strong> <em>condition</em> :</div>
<div class="line-block">
<div class="line"><strong>return</strong> <em>bool decision</em></div>
</div>
</div>
<blockquote>
<div><ul class="simple">
<li><p>after If-instruction the selection set is (probably) reduced, and next instruction is applied to this reduced set; next instruction is one more If-instruction, or…</p></li>
<li><p>final instruction in code is always Return-instruction that determines what should be done to the rest of working selection: to include it in the “final selection” (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or to exclude it (<code class="docutils literal notranslate"><span class="pre">False</span></code>):</p></li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line"><strong>return</strong> <em>bool decision</em></div>
</div>
<p>There is only one other type of available instruction, Label-instruction:</p>
<div class="line-block">
<div class="line"><strong>label</strong> (<em>string</em>)</div>
</div>
<p>This instruction can be inserted to decision tree code before any If-instruction. So the user has a possibility to mark state of working selection by label mark. This mark can be used in complex procedures (see <a class="reference internal" href="func_ref.html"><span class="doc">Filtering functions</span></a>, functions <a class="reference internal" href="func_ref.html#compound-heterozygous"><span class="std std-ref">Compound_Heterozygous()</span></a> and <a class="reference internal" href="func_ref.html#compound-request"><span class="std std-ref">Compound_Request()</span></a>).</p>
</section>
<section id="syntax-principles">
<h2>Syntax principles<a class="headerlink" href="#syntax-principles" title="Permalink to this heading">¶</a></h2>
<p>There are three levels of details in description of Decision Tree Python dialect:</p>
<ul>
<li><p><strong>neccessary level</strong>: the dialect deals with very restricted subset of Python, so only small amount of Python constructions are allowed in it; below is complete description of this subset</p></li>
<li><p><strong>good practice level</strong>: some constructs discussed below are recommended as “good practice”; similar constructs that are not considered good practices could be refactored to their “good practice” analogues in the process of interactive changes of a decision tree</p></li>
<li><p><strong>simplification level</strong>: since the dialect of Python is very “thin”, for purposes of easy typing and reading it supports the following “simplifications”:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>string constants</strong> can be typed without quote symbols <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">''</span></code> if they are correct Python identifiers or constants <code class="docutils literal notranslate"><span class="pre">True,</span> <span class="pre">False,</span> <span class="pre">None</span></code></p></li>
<li><p><strong>lists vs. sets</strong>: in case when code refers list objects with <code class="docutils literal notranslate"><span class="pre">[]</span></code> parentheses, it is good practice to use set notation with <code class="docutils literal notranslate"><span class="pre">{}</span></code>; indeed in most cases, order of elements in a “list” is irrelevant, while <code class="docutils literal notranslate"><span class="pre">{}</span></code> are more readable</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="top-level-constructions">
<h2>Top level constructions<a class="headerlink" href="#top-level-constructions" title="Permalink to this heading">¶</a></h2>
<p>There are three top level constructions available in the dialect:</p>
<div class="line-block">
<div class="line"><strong>if</strong> <em>condition</em> :</div>
<div class="line-block">
<div class="line"><strong>return</strong> <em>bool decision</em></div>
<div class="line"><br /></div>
</div>
<div class="line"><strong>return</strong> <em>bool decision</em></div>
<div class="line"><br /></div>
<div class="line"><strong>label</strong> (<em>string</em>)</div>
</div>
<p>The following rules must be hold:</p>
<blockquote>
<div><ul class="simple">
<li><p>All instructions (excluding Return-sub-instruction of If-instruction) must start at the first character of a line, no indentation</p></li>
<li><p>A top-level Return-instruction must be the last nonempty line of code</p></li>
<li><p>Label-instruction can be used before any If-instruction</p></li>
<li><p>Empty lines between top-level constructions are allowed</p></li>
<li><dl class="simple">
<dt>Comments are acceptable only as a full line, not as a part of a line with code;</dt><dd><p>comments should start with <code class="docutils literal notranslate"><span class="pre">#</span></code> character, possibly after spaces (note also that comments are not acceptable after the last instruction)</p>
</dd>
</dl>
</li>
<li><p>It is a good practice to place comment lines only before top-level instructions</p></li>
<li><dl class="simple">
<dt><em>condition</em> in If-instruction might be quite long, so one might need multiple lines;</dt><dd><p>It is good practice to use parentheses to group these lines, instead of <code class="docutils literal notranslate"><span class="pre">\</span></code> characters.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</section>
<section id="condition-constructions">
<h2>Condition constructions<a class="headerlink" href="#condition-constructions" title="Permalink to this heading">¶</a></h2>
<section id="combined-conditions">
<h3>Combined conditions<a class="headerlink" href="#combined-conditions" title="Permalink to this heading">¶</a></h3>
<p>Operators <code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">or</span></code> and <code class="docutils literal notranslate"><span class="pre">not</span></code> and parentheses <code class="docutils literal notranslate"><span class="pre">()</span></code> are fully supported for building complex conditions from atomic ones.</p>
<p>Atomic condition uses identifier of corresponding filtering property`once per atomic condition.</p>
</section>
<section id="atomic-numeric-condition">
<h3>Atomic numeric condition<a class="headerlink" href="#atomic-numeric-condition" title="Permalink to this heading">¶</a></h3>
<p>Has form of usual Python comparison operation with operators <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>. Double form is acceptable, for example:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><em>min value</em> &lt; <em>property_id</em> &lt;= <em>max_value</em></div>
</div>
</div></blockquote>
<p>Best practice: use only operators <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">==</span></code>; in case of operator <code class="docutils literal notranslate"><span class="pre">==</span></code> place property identifier on the left.</p>
</section>
<section id="atomic-enumerated-condition">
<h3>Atomic enumerated condition<a class="headerlink" href="#atomic-enumerated-condition" title="Permalink to this heading">¶</a></h3>
<p>Has different form in dependency of join mode of condition:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><strong>OR</strong>:</div>
<div class="line-block">
<div class="line"><em>property_id</em> <strong>in</strong> <code class="docutils literal notranslate"><span class="pre">{</span></code> <em>set</em>/<em>list of value strings</em> <code class="docutils literal notranslate"><span class="pre">}</span></code></div>
<div class="line"><br /></div>
</div>
<div class="line"><strong>AND</strong>:</div>
<div class="line-block">
<div class="line"><em>property_id</em> <strong>in</strong> <strong>all</strong> <code class="docutils literal notranslate"><span class="pre">({</span></code> <em>set</em>/<em>list of value strings</em> <code class="docutils literal notranslate"><span class="pre">})</span></code></div>
<div class="line"><br /></div>
</div>
<div class="line"><strong>NOT</strong>:</div>
<div class="line-block">
<div class="line"><em>property_id</em> <strong>not in</strong> <code class="docutils literal notranslate"><span class="pre">{</span></code> <em>set</em>/<em>list of value strings</em> <code class="docutils literal notranslate"><span class="pre">}</span></code></div>
<div class="line"><br /></div>
</div>
</div>
</div></blockquote>
<p>Notes:</p>
<blockquote>
<div><ul>
<li><p>notation above uses <code class="docutils literal notranslate"><span class="pre">{}</span></code> set parentheses; though it is recommended as a good practice, list parentheses <code class="docutils literal notranslate"><span class="pre">[]</span></code> are also supported</p></li>
<li><p>operator <strong>in</strong> is supported for all enumerated properties, including status (single-value) and multiset (multi-value) properties.</p>
<blockquote>
<div><p>For status property its semantic is simple and intuitive.</p>
<p>In case of multiset property this notation is more sophisticated: the condition is positive when intersection of two sets is nonempty, i.e. at least one value of the property matches at least one value in the given set; it can be “explained” by a way that object representing filtering property redefines operator <strong>in</strong> from the left</p>
</div></blockquote>
</li>
<li><p>in case of <strong>AND</strong> join mode interpretation of <strong>all()</strong> pseudo-function is even more sophisticated: it can be “explained” if result of <strong>all()</strong> redefines” <strong>in</strong> operation in a very specific way from the right.</p></li>
<li><p>in terms of Decision Tree there is no strong need for <strong>NOT</strong> join mode, because operator <code class="docutils literal notranslate"><span class="pre">not</span></code> is supported outside atomic conditions</p></li>
</ul>
</div></blockquote>
</section>
<section id="atomic-function-conditions">
<h3>Atomic function conditions<a class="headerlink" href="#atomic-function-conditions" title="Permalink to this heading">¶</a></h3>
<p>Function conditions have similar form to enumerated conditions with a  change of <em>property id</em> to</p>
<blockquote>
<div><p><em>function_name</em> (<em>parameters</em>)</p>
</div></blockquote>
<p>Syntax for parameters is Python standard. Since all values of the parameters must be JSON objects (however, with a change of JS constants <code class="docutils literal notranslate"><span class="pre">true/false/null</span></code> to Python counterparts <code class="docutils literal notranslate"><span class="pre">True/False/None</span></code>), there should be no problems in setting parameters up. (“Simplifications” are also acceptable for parameters).</p>
<p>See <a class="reference internal" href="func_ref.html"><span class="doc">Filtering functions</span></a> for reference of available functions and their parameters.</p>
</section>
<section id="property-and-function-identifiers">
<h3>Property and function identifiers<a class="headerlink" href="#property-and-function-identifiers" title="Permalink to this heading">¶</a></h3>
<p>Each identifier used as property or function (<em>property_id</em> or <em>function_name</em> above) corresponds to only one property or function available in evaluation space. So each available identifier can be used in only one type of atomic conditions.</p>
<p>However, identifier of an atomic condition can be absent in evaluation space, and the corespondent atomic condition is considered as correct but inactive: it is interpeted as always negative (and positive in <strong>NOT</strong> mode of enumerated and function conditions).</p>
</section>
</section>
<section id="decision-tree-system-support">
<h2>Decision Tree system support<a class="headerlink" href="#decision-tree-system-support" title="Permalink to this heading">¶</a></h2>
<p>The following objects are explicated from the code of decision tree:</p>
<ul class="simple">
<li><p><strong>Points</strong> correspond to instruction in code; each If- or Return- instruction corresponds to a point with state of selection set: either working one or pre-final. The user needs to know how many items (variants) are in these sets, and moreover has possibility to study distribution of values for filtering properties of items in these sets.</p></li>
<li><p><strong>Atomic conditions</strong> are “atomic” fragments of condition in If instructions. There can be many atomic conditions in one If instruction. It is important functionalify of the system to locate them and provide their modifications.</p></li>
<li><p><strong>State labels</strong> can be defined in code by Label instructions. They are used with complex functions. This functionalify requires high level of qualification and attendacy of the user, however it might be very important in practice.</p></li>
</ul>
<p>A decision tree can be modified in either of two ways:</p>
<ul class="simple">
<li><p>manual typing and modifications of decision tree code</p></li>
<li><p>interactive actions modifying various details of decision tree</p></li>
</ul>
<p>Interactive regime allows to make any meaningful transformation of decision tree, so there is no strong need to use manual regime at all. Manual regime requires is helpful for complex manipulations with boolean logic of conditions and, of course for copy/paste operations.</p>
</section>
<section id="see-also">
<h2>See also<a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="func_ref.html"><span class="doc">Filtering functions</span></a></p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Decision Tree Syntax Reference</a><ul>
<li><a class="reference internal" href="#decision-tree-logic">Decision tree logic</a></li>
<li><a class="reference internal" href="#syntax-principles">Syntax principles</a></li>
<li><a class="reference internal" href="#top-level-constructions">Top level constructions</a></li>
<li><a class="reference internal" href="#condition-constructions">Condition constructions</a><ul>
<li><a class="reference internal" href="#combined-conditions">Combined conditions</a></li>
<li><a class="reference internal" href="#atomic-numeric-condition">Atomic numeric condition</a></li>
<li><a class="reference internal" href="#atomic-enumerated-condition">Atomic enumerated condition</a></li>
<li><a class="reference internal" href="#atomic-function-conditions">Atomic function conditions</a></li>
<li><a class="reference internal" href="#property-and-function-identifiers">Property and function identifiers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#decision-tree-system-support">Decision Tree system support</a></li>
<li><a class="reference internal" href="#see-also">See also</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="func_ref.html"
                          title="previous chapter">Filtering functions</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="zygosity.html"
                          title="next chapter">Notes on Zygosity</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/dtree_syntax.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="zygosity.html" title="Notes on Zygosity"
             >next</a> |</li>
        <li class="right" >
          <a href="func_ref.html" title="Filtering functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Anfisa User Documentation v.0.7 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Decision Tree Syntax Reference</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Copyright (c) 2019-2022. Partners HealthCare and other members of Forome Association.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
  </body>
</html>